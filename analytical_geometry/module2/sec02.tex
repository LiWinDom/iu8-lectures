\section{Матрицы}

\begin{definition}
  \textit{Матрицей} называется таблица чисел, в которой элементы расположены по строкам и столбцам.
\end{definition}

Обозначаются заглавными латинскими буквами: $A, B, C \ldots$
Размерность матрицы определятся кол-вом строк $m$ и кол-вом столбцов  $n$, и обозначается $m \times n$.
Элемент матрицы $a_{ij}$ -- элемент, который расположен в $i$-ой строку и  $j$-ом столбце.

Матрицу можно записать таким образом:  \[
A = 
\begin{pmatrix}
  a_{11} & a_{12} & \ldots & a_1m \\ 
  a_{21} & a_{22} & \ldots & a_2m \\ 
  \ldots & \ldots & \ldots & \ldots \\
  a_{n1} & a_{n2} & \ldots & a_nm \\ 
\end{pmatrix}
\]

\begin{definition}
  Матрица называется \textit{квадратной} если кол-во строк равно кол-ву столбцов ($m = n$).
\end{definition}

\begin{definition}
  Квадратная матрица называется \textit{диагональной} если все элементы матрицы, кроме элементов на главной диагонали, равны нулю. \[
  A = \begin{pmatrix}
    1 & 0 & 0 \\
    0 & 2 & 0 \\
    0 & 0 & 3
  \end{pmatrix}
  \] 
\end{definition}

\begin{definition}
  \textit{Главной диагональю} называется диагональ матрицы, идущая из левого верхнего в правым нижний.
\end{definition}

\begin{definition}
  \textit{Побочной диагональю} называется диагональ матрицы, идущая из левого верхнего в правым нижний.
\end{definition}

\begin{definition}
  Квадратная матрица, у которой на главной диагонали все элементы равны единице, а остальные равны нулю, называют \textit{единичной}. \[
  B = \begin{pmatrix}
    1 & 0 & 0 \\
    0 & 1 & 0 \\
    0 & 0 & 1
  \end{pmatrix}
  \] 
\end{definition}

\begin{definition}
  \textit{Нулевой матрицей} называется матрица, все элементы которой равные нулю. \[
  \Theta = \begin{pmatrix}
    0 & 0 & 0 \\
    0 & 0 & 0
  \end{pmatrix}
  \] 
\end{definition}

\begin{definition}
  \textit{Верхне-треугольной матрицей} называется квадратная матрица, у которой под главной диагональю равны нулю. \[
  C = \begin{pmatrix}
    1 & 2 & 3 \\
    0 & 4 & 5 \\
    0 & 0 & 6
  \end{pmatrix}
  \] 
\end{definition}

\begin{definition}
  \textit{Нижне-треугольной матрицей} называется квадратная матрица, у которой под главной диагональю равны нулю. \[
  D = \begin{pmatrix}
    1 & 2 & 3 \\
    4 & 5 & 0 \\
    6 & 0 & 0
  \end{pmatrix}
  \] 
\end{definition}

Две матрицы \textit{равны}, если они имеют одинаковую размерность, и их соответствующие элементы равны. 

\subsection{Действия с матрицами}

\begin{definition}
  \textit{Суммой матриц} $A_{m \times n}$ и $B_{m \times n}$ называется матрица $C_{m \times n}$, элементы которой являются суммой соответствующих элементов матриц $A$ и $B$. \[
  C = A + B = \begin{pmatrix}
    1 & 2 \\
    3 & 4
  \end{pmatrix}
  +
  \begin{pmatrix}
    -1 & -1 \\
    -2 & 0
  \end{pmatrix}
  =
  \begin{pmatrix}
    0 & 1 \\
    1 & 4
  \end{pmatrix}
  \] 
\end{definition}

\begin{definition}
  \textit{Произведением матрицы} $A_{m \times n}$ на число $k = const$ называется матрица $C_{m \times n}$, элементы которой равны произведению соответствующего элемента матрицы на данное число $c_{ij} = k a_{ij}$.
\end{definition}

\subsubsection{Свойства сложения и произведения матриц на число}

\begin{enumerate}
  \item \[
    A + B = B + A
  \] 

  \item \[
   (A + B) + C = A + (B + C_
    \]

  \item Если $\theta$ -- нулевая матрица, то: \[
    A + \theta = A
  \] 

  \item Найдётся такая матрица $B$, что:  \[
    A + B = 0
  \]  

  \item \[
  \lambda (A + B) = \lambda A + \lambda B
  \] 

  \item \[
      (\lambda + \rho) A = \lambda A + \rho A
  \] 

 \item \[
    (\lambda \rho) A = 
 \] 
\end{enumerate}

\subsection{Транспонирование матрицы}

\begin{definition}
  \textit{Транспонированной матрицей} $A_{mn}$ называется матрица размерностью $n \times  m$, элементы которой:
  \begin{gather*}
    a^\tau_{ij} = a_{ji} \\
    A_{n \times m}^\tau \text{ -- транспонированная матрица } A_{m \times n}
  \end{gather*}
  \begin{gather*}
    A_{2 \times 3} = 
    \begin{pmatrix}
      1 & 2 & 3 \\
      4 & 5 & 6
    \end{pmatrix} \\
    A^\tau_{3 \times 2} = 
    \begin{pmatrix}
      1 & 4 \\
      2 & 5 \\
      3 & 6
    \end{pmatrix}
  \end{gather*}
\end{definition}

\subsubsection{Свойства транспонированния}

\begin{enumerate}
  \item \[
      (A + B)^\tau = A^\tau + B^\tau
  \] 

  \item \[
    (\lambda A)^\tau = \lambda A^\tau
\] 
\end{enumerate}

\subsection{Произведение матриц}

\begin{definition}
  \textit{Произведением матриц} $A$ и $B$ назвается матрица $C$, элементы которой определяются как: \[
    c_{ij} = \sum_{l=1}^{k} a_{il} \cdot b_{lj}
  \] 
\end{definition}

\begin{note}
  Две матрицы можно перемножить, если количество столбцов одной матрицы равно количеству строк другой матрицы. Тогда результирующая матрица будет иметь количество строк одной матрицы и количеству столбцов другой матрицы. \[
    C_{a \times b} = A_{a \times c} \cdot B_{c \times b}
  \] 
\end{note}

\textit{Свойство антикомунитативности} произведения матриц. 
\[
  A \times B \neq B \times A
\]

\begin{note}
  \textit{Исключения:} 
  Когда $A = B$:  \[
  
    A \times B = A \times A = A^2
  \]  
  Когда матрица $B$ -- нулевая матрица:
  \[
    A \times \theta = \theta
  \] 

  Когда матрица  $B$ -- единичная матрица:
  \[
    A \times E = A
  \] 

  Когда матрица $B$ -- обратная матрица:
  \[
    A \times A^{-1} = E
  \] 
\end{note}

\subsubsection{Свойства произведения матриц}

\begin{enumerate}
  \item Произведение матриц антикомунитативно. \[
  A \times B \neq  B \times A
  \] 
  \item \[
  1 \times A = A
  \] 

  \item Ассоциативность \[
      (A \times B) \times C = A \times (B \times C)
  \]
  Доказательство:
  \begin{align*}
    \left( A \times  B \right) C &= \\
    &= \sum_{r=1}^{k} [(A \times B)]_{ir} \times [C]_{rj} = \\
    &= \sum_{r=1}^{n} \left( \sum_{s=1}^{k} [A]_{is} \cdot [B]_{sn} \right) \cdot [C]_{rj} = \\
    &= \sum_{n=1}^{n} \sum_{k=1}^{k} [A]_{is} \times [B]_{sn} \times [C]_{rj} = \\
    &= \sum_{s=1}^{k} [A]_{is} \times [\left( B \times C \right) ] =\\
    &= A \times (B \times C)
  \end{align*}

  \item Дистрибутивность произведения матриц относительно сложения: \[
      (A + B) \times C = A \times C + B \times C
  \] 
  Доказательство:
  \begin{align*}
    \left(A_{m \times k} + B_{m \times k}\right) \times C_{k \times n} &= \\
    &= \sum_{r+1}^{k} [\left( A + B \right) ]_{ir} \times [C]_{ir} \\
    &= \sum_{r=1}^{k} \left( [A]_{ir} + [B]_{ir} \right) \times [C]_{rj} \\
    &= \sum_{r=1}^{k} \left( [A]_{ir} [C]_{rj} + [B]_{ir} \times [C]_{rj} \right) \\
    &= \sum_{r=1}^{k} [A]_{ir} [C]_{ir} + \sum_{r=1}^{k} [B]_{ir} [C]_{ir} \\
    &= A \times C + B \times C
  \end{align*}

\item Применение транспорирования к произведению матриц \[
      (A \times B)^\tau = B^\tau \times A^\tau
  \]  
  Доказательство:
  \begin{align*}
    \left( A \cdot B \right)^\tau &= \\
    &= [ \left( A \times B \right)^\tau ]_{ij} \\
    &= [A B]_{ji} = \sum_{r=1}^{k} [A]_{jr} \times [B]_{ri} \\
    &= \sum_{r=1}^{k} [A^\tau] \times [B^\tau]_{ir} \\
    &= \sum_{r=1}^{k} [B^\tau]_{ir} [A^\tau]_{rj} \\
    &= [B^\tau \times A^\tau] \\
    &=B^\tau \times A^\tau
  \end{align*}
\end{enumerate}

\subsection{Элементарные преобразования матриц}

\begin{enumerate}
  \item Перестановка строк и столбцов.
  \item Умножение элементов строк (столбцов) на число.
  \item Прибавление к элементам одной строки соответствующий элементов другой строки (столбца), умноженного на число.
\end{enumerate}

Используя элементарные преобразования, можно привести любую матрицу к \textit{ступенчатому виду}.
\begin{eg}
  Пример ступенчатой матрицы для $3 \times 4$:
  \[
  \begin{pmatrix}
    1 & 2 & 3 & 4 \\
    0 & 3 & 4 & 5 \\
    0 & 0 & 6 & 7
  \end{pmatrix}
  \] 
\end{eg}

\subsection{Минор матрицы. Ранг матрицы}

\begin{definition}
  \textit{Минором k-ого порядка} матрицы $A$ называется определитель, составленный из пересечения $k$ строк и $k$ столбцов с сохранением их порядка.
\end{definition}

\begin{definition}
  \textit{Окаймляющим минором} для минора $M$ матрицы $A$ называется минор $M'$, полученный из минора $M$ путём добавления 1 строки и 1 столбца.
\end{definition}

\begin{definition}
  \textit{Базисным минором} называется матрицы $A$ называется минор, не равный нулю, порядок которого равен рангу матрицы $A$.
\end{definition}

\begin{definition}
  \textit{Рангом матрицы} называется число $A$, равное наибольшему порядку, отличному от нуля, минора матрицы $A$.
\end{definition}

\begin{theorem}
  \textit{О базисном миноре}. \\ 
  Строки (столбцы) матрицы $A$, входящие в базисный минор -- базисы. \\
  Базисные строки (столбцы), входящие в базисный минор -- линейно-независимы. \\
  Любую строку (столбец), не входящую в базисный минор, можно представить в виде линейной комбинации базисных строк (столбцов).
\end{theorem}
\begin{proof}
  Пусть ранг матрицы A равен R. \\
  Предположим, что строки матрицы $A$ - линейно-зависимы. 
  Тогда одну из ни можно выразить как линейную комбинацию других строк. 
  Тогда в базисном миноре 1-ая строка -- линейная комбинация других строк. 
  По свойству определителей этот минор равен нулю, что противоречит определению базисного минора. \\
  \\
  Пусть базисный минор состоит из первых $r$ строк и $r$ столбцов матрицы $A$. 
  Добавим к этому минору произвольную i-ную строку и j-ный столбец -- получим окаймляющий минор. 
  Если $j \le r$, то в миноре $M'$ 2 одинаковых столбца и минор равен нулю.
  Если $j > r$, то в минор  $M'$ тоже равен нулю, т.к. ранг матрицы A равен r, наибольний порядок, отличный от нуля, минора равен $j$. \\
  \\
  Определитель можно вычислить путём разложения по каой-нибудь строке или столбцу, поэтому найдем определитель $M'$ путём разложения по j-ному столбцу:
   \begin{gather*}
     a_{1j} A_{1j} + a_{2j} A_{2j} + \ldots + a_{ij} A_{ij} = 0 \\
     j = r + 1 \implies \\
     a_{1r+1} A_{1r+1} + a_{2r+1} A_{2r+1} + \ldots + a_{ir+1} A_{ir+1} = 0 \\
  \end{gather*}
  $A_{r+1,r+1}$ -- базисный минор, т.к. $M \neq 0$, то $A_{r+1,r+1} \neq 0$.
  \begin{gather*}
    a_{r+1,r+1} =
    - \frac{A_{1,r+1}}{A_{r+1,r+1}} \cdot  a_{1,r+1}
    - \frac{A_{2,r+1}}{A_{r+1,r+1}} \cdot  a_{2,r+1}
    \ldots
    - \frac{A_{r,r+1}}{A_{r+1,r+1}} \cdot  a_{r,r+1}
  \end{gather*}
  Обозначим $\lambda_i = -\frac{A_{i,r+1}}{A_{r+1}{r+1}}$
  \begin{gather*}
    a_{r+1,r+1} = \lambda_i a_{1,r+1} + \lambda_2 a_{2,r+1} + \ldots + \lambda_r \cdot a_{r,r+1} \\
  \end{gather*}
  Элементы $i$-ой строки можно представить в виде линейной комбинации строк.
\end{proof}

\subsubsection{Вычисление ранга матрицы}

Ранг матрицы обозначается: \[
  Rg(A), rg A
\] 

\subsubsection*{Метод окаймляющего минора} 

Выбираем любой элемент матрицы $A \neq 0$ -- минор.
Составляем окаймляющий минор и вычисляем его. Если он не равен 0, то составляющий минор 3 порядка и т.д.
Если равен нулю, то берём другой элемент матрицы и соответствующий ему окаймляющий минор.
Ранг матрицы будет равен размеру максимального минора, не равному нулю.

\subsubsection*{Метод элементарных преобразований}

\begin{theorem}
  Ранг матрицы не меняется при элементарных преобразований строк (столбцов) матрицы.
  Ганг матрицы равен количеству ненулевых строк (столбцов) ступенчатой матрицы, полученной путём элементарных преобразований.
\end{theorem}

\subsection{Обратная матрица}

\begin{definition}
  \textit{Обратная матрица} квадратной матрицы A_{n x n} называется матрица $A^{-1}_{n x n}$ такая, что $A \times A^{-1} = A^{-1} \times A = E$.
\end{definition}

Обратная матрица вычисляется по формуле:
\begin{gather*}
  \boxed{
    A^{-1} = \frac{1}{det A} \cdot 
    \begin{pmatrix}
      A_{11} & A_{12} & \ldots & A_{1n} \\
      A_{21} & A_{22} & \ldots & A_{2n} \\
      \ldots & \ldots & \ldots & \ldots \\
      A_{n1} & A_{n2} & \ldots & A_{nn} \\
    \end{pmatrix} ^ \tau
  }
\end{gather*}
где $A_{ij} = (-1)^{i+j} M_{ij}$ -- арифметическое дополнение $a_{ij}$ матрицы A.

\begin{definition}
  Матрица $A^*$, являющаяся транспонированной матрицей алгебраических дополнений матрицы A называется  \textit{присоединённой матрицей}. 
\end{definition}

\begin{theorem}
  Для того, чтобы матрица $A$ имела обратную необходимо и достаточно, чтобы её определитель не равнялся нулю.
\end{theorem}
\begin{proof}
  1) Пусть матрица A имеет обратную, тогда по определению: \[
    A \times A^{-1} = E
  \]
  В таком случае:
  \begin{gather*}
    det(A \times A^{-1}) = det(E) = 1 \\
    det(A \times A^{-1}) = det(A) \cdot det(A^{-1}) = 1 \implies det A \neq 0
  \end{gather*}

  2) Пусть $det A \neq 0$. Если матрицн разложить по строке или столбцу:
  \begin{align*}
    &\sum_{j+1}^{n} a_{ij} A_{ij} = a_{i1} A_{i1} + a_{i2} A_{i2} + \ldots + a_{in} A_{in} = det A \\
    &\sum_{j+1}^{n} a_{ij} A_{nj} = a_{i1} A_{n1} + a_{i2} A_{n2} + \ldots + a_{in} A_{nn} = 0 \quad i \neq k
  \end{align*}

  Пусть существует матрица $B$: \[
    b_{ij} = \frac{A_{ij}}{det A}
  \] 
  Пусть $C = A \cdot B$:
  \begin{gather*}
    c_{ij} = \sum_{k=1}^{n} a_{ik} \cdot b_{in} = \sum_{n=1}^{n} a_{ik} \frac{A_{jn}}{det A} \\
    = \frac{1}{det A} \cdot \sum_{n=1}^{n} a_{ik} A_{jn} = \begin{cases}
      \frac{1}{det A} \cdot det A = 1, \quad \text{ если } i=j \\
      \frac{1}{det A} \cdot 0 = 0, \quad \text{ если } i \neq j
    \end{cases} \implies C = E \\
    c_{ij} = 1, \text{ если } i=j \\
    c_{ij} = 0, \text{ если } i \neq j
  \end{gather*}

  Получим: 
  \begin{gather*}
    \begin{rcases}
      A \times B = E \\
      B \times A = E
    \end{rcases} \implies \text{ по определению } B = A^{-1}
  \end{gather*}
\end{proof}

\begin{theorem}
  Пусть матрицы $A_{n x n}$ и  $B_{n x n}$ имеют обратные $A^{-1}_{n x n}$ и  $B^{-1}_{n x n}$, тогда: \[
    (A \times B)^{-1} = B^{-1} \times A^{-1}
  \]
\end{theorem}
\begin{proof}
  \begin{align*}
    (A \times B) \times (A \times B)^{-1} &= (A \times B) \times (B^{-1} \times A^{-1}) \\ 
                          &= A \cdot (B \cdot B^{-1}) \cdot A^{-1} \\
                          &= A \cdot E \cdot A^{-1} = A \times A^{-1} = E \\
    (A \times B)^{-1} \times (A \times B) &= (A^{-1} \times B^{-1}) \times (B \times A) \\ 
                          &= B^{-1} \times (A \times A^{-1}) \times B \\
                          &= B^{-1} \times E \times B = B^{-1} \times B = E
  \end{align*}
\end{proof}

\begin{theorem}
  Пусть матрца $A_{nxn}$ имеет обратную $A^{-1}_{nxn}$. Тогда: \[
    \left( A^\tau \right) ^{-1} = \left( A^{-1} \right) ^\tau
  \] 
\end{theorem}
\begin{proof}
  \begin{align*}
    A^\tau \times (A^\tau)^{-1} &= A^\tau \times \left( A^{-1} \right)^\tau = (A \times A^{-1})^\tau = E^\tau = E \\
    (A^\tau)^{-1} \times A^\tau &= \left( A^{-1} \right)^\tau \times A^\tau = (A^{-1} \times A)^\tau = E^\tau = E
  \end{align*}
\end{proof}

\begin{definition}
  Матрица $A$, определитель которой не равен нулю, называется \textit{невырожденной}.
\end{definition}

\begin{definition}
  Матрица $A$, определитель которой равен нулю, называется \textit{вырожденной}.
\end{definition}

\begin{note}
  \textit{Невырожденную матрицу} называют \textit{обратимой}. 
\end{note}

\subsection{Вычисление обратной матрицы}

\subsubsection*{Способ 1. По формуле}

По формуле:
\begin{gather*}
  A^{-1} = \frac{1}{det A}
  \begin{pmatrix}
    A_{11} & A_{12} & \ldots & A_{1n} \\
    A_{21} & A_{22} & \ldots & A_{2n} \\
    \ldots & \ldots & \ldots & \ldots \\
    A_{n1} & A_{n2} & \ldots & A_{nn}
  \end{pmatrix}^{\tau}
\end{gather*}

\begin{enumerate}
  \item Находим определитель матрицы $A$.
  \item Находим все алгебраические дополнения: \[
      A_{ij} = (-1)^{i + j} M_{ij}
  \] 
  \item Подставляем алгебраические дополнения
  \item Транспонируем матрицу
  \item Домножаем на $\frac{1}{det A}$
\end{enumerate}

\subsubsection*{Проверка получения обратной матрицы}

По свойству: \[
  A^{-1} \cdot A = A \cdot A^{-1} = E
\] 

\subsubsection*{Способ 2. Метод Жордана-Гаусса (с помощью элементарных преобразований)}

Данный способ подходит для больших матриц.

\begin{enumerate}
  \item Приписываем к матрице справа единичную матрицу такой же размерности. \[
  A | E
  \] 
  \item С помощью элементарных преобразований строк всей матрицы приводим матрицу $A$ к верхне-треугольному виду.
    На первом шаге -- переписываем строку без изменения, и с помощью элементарных преобразований получаем нулевые элементы в первом столбце матрицы $A$ под элементом  $a_{11}$. 
    На втором шаге, переписываем первые две строки матрицы, и спомощью элементарных преобразований строк получаем нулевые элементы в первом столбце под элементом $a_{22}$.

  \item С помощью элементарных преобразований строк получаем в левой части диагональную матрицу. 
    На первом шаге -- переписываем последнюю строку без изменений. 
    С помощью элементарных преобразований получаем нулевые элементы в последнем столбце над элементов $a'_{nn}$. 
    Во втором шаге переписываем без изменения последние две строки, и с помощью элементарных преолбразований получаем нулевые элементы в предпоследнем столбце над элементом  $a'_{n-1 n-1}$. 
    И так далее.

  \item Делим каждую строку на соответствующий элемент диагональный элемент левой части матрицы. 
    В результате в левой части получаем единичную матрицу, а вправой -- обратную матрицу матрице $A$.
\end{enumerate}

\begin{note}
  Если $a_{11}$ равен нулю, то переставляем две строки матрицы так, чтобы $a_{11}$ не был равен нулю.
\end{note}

\begin{eg}
  \begin{gather*}
    A | E = 
    \left(\begin{matrix}
      1 & 0 & -1 \\
      -1 & 2 & 3 \\
      3 & 1 & 0
    \end{matrix}\right|\left
    \begin{matrix}
      1 & 0 & 0 \\
      0 & 1 & 0 \\
      0 & 0 & 1
    \end{matrix}\right) \sim  
    \left( 
    \begin{matrix}
      1 & 0 & -1 \\
      0 & 2 & 2 \\
      0 & 0 & -4
    \end{matrix}\right|\left
    \begin{matrix}
      1 & 0 & 0 \\
      1 & 1 & 0 \\
      7 & 1 & -2
    \end{matrix}
    \right) \sim \\ 
    \left( 
    \begin{matrix}
      -4 & 0 & 0 \\
      0 & 4 & 0 \\
      0 & 0 & -4 
    \end{matrix} \right| \left
    \begin{matrix}
      3 & 1 & -2 \\
      9 & 3 & -2 \\
      7 & 1 & -2
    \end{matrix}
    \right) \sim 
    \left( 
    \begin{matrix}
      1 & 0 & 0 \\
      0 & 1 & 0 \\
      0 & 0 & 1
    \end{matrix} \right|\left
    \begin{matrix}
      -\frac{4}{4} & -\frac{1}{4} & \frac{2}{4} \\
      \frac{9}{4} & \frac{3}{4} & -\frac{2}{4} \\
      -\frac{7}{4} & -\frac{1}{4} & \frac{2}{4}
    \end{matrix}
    \right) 
  \end{gather*}
\end{eg}

